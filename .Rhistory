#"pMicroSurv":                Univariate p-value of survival (vumc data, 2 genes were selected on Neomark and have a high pvalue)
#"pvalSurvNM":              This contains two values, for the two genes selected on NM data
#"Survival":        Survival, 1 is event/death
#"SurvivalSubset":Survival genes (some overlap with N stage)
#"xPCR":             PCR data (houskeeping gene GUSB subtracted)
pSurv <- pMicroSurv
pSurv[!is.na(pvalSurvNM)] <- pvalSurvNM[!is.na(pvalSurvNM)]
pSurv[SurvivalSubset]                                                  #survival p-values for survival genes
pSurv[SurvivalSubset & LassoSurv]                        #survival p-values Lasso genes
pSurv[NStageSubset]                                                   #survival p-values for N stage genes
pMicroNstage[NStageSubset]                                 #N stage p-values for N stage genes
pMicroNstage[NStageSubset & LassoNStage]  #N stage p-values Lasso genes
pMicroNstage[SurvivalSubset]                                #N stage p-values for survival  genes
whmiss <- which(is.na(apply(xPCR,2,mean)))
xPCR2 <- xPCR[,-whmiss]
pSurv2 <- pSurv[-whmiss]
pMicroNstage2 <- pMicroNstage[-whmiss]
LassoNStage2 <- LassoNStage[-whmiss]
LassoSurv2 <- LassoSurv[-whmiss]
SurvivalSubset2 <- SurvivalSubset[-whmiss]
NStageSubset2 <- NStageSubset[-whmiss]
pcrsd <- apply(xPCR2,2,sd)
dim(xPCR2)
resp <- factor(NStage)
xPCR2cen <- t(t(xPCR2) - apply(xPCR2,2,mean))
xPCR2stand <- t(t(xPCR2cen)/apply(xPCR2cen,2,sd))
firstPartition <- CreatePartition(pcrsd,decreasing=TRUE,uniform=TRUE,grsize=9)
secondPartition <- CreatePartition(pMicroNstage2,decreasing=FALSE,uniform=TRUE,grsize=9)
thirdPartition <- CreatePartition(factor(LassoNStage2))
partitionsOramod0 <- list(pvals=secondPartition,
lassosel=thirdPartition)
partitionsOramod <- list(sds=firstPartition,pvals=secondPartition,
lassosel=thirdPartition)
grOra <- grridge(t(xPCR2cen),resp,unpenal=~1,partitionsOramod,innfold=ncol(xPCR2cen),
monotone = c(FALSE,TRUE,FALSE),
selection=TRUE,stepsel=1,maxsel=15,comparelasso=TRUE, savepredobj="all",method="exact")
library(GRridge)
library(GRridge)
setwd("C:\\VUData\\Dennis")
load("OraMod.Rdata")
#"cNStage":                      Clinical N stage
#"ConcludingN":             N stage + delayed lymph node (alleen vumc)
#"CoxTime":      Time of death or time of censoring
#"LassoNStage":             lasso selected for N stage (thus lower p-value for N stage)
#"LassoSurv":   lasso selected for survival (thus lower p-value for survival)
#"NStage":                        Combination of ConcludingN (for vumc) and clinical N (for parma)
#"NStageSubset":          N stage genes
#"pMicroNstage":          Univariate p-value of N stage (on vumc micro data only, and not fishers combined p-vale)
#"pMicroSurv":                Univariate p-value of survival (vumc data, 2 genes were selected on Neomark and have a high pvalue)
#"pvalSurvNM":              This contains two values, for the two genes selected on NM data
#"Survival":        Survival, 1 is event/death
#"SurvivalSubset":Survival genes (some overlap with N stage)
#"xPCR":             PCR data (houskeeping gene GUSB subtracted)
pSurv <- pMicroSurv
pSurv[!is.na(pvalSurvNM)] <- pvalSurvNM[!is.na(pvalSurvNM)]
pSurv[SurvivalSubset]                                                  #survival p-values for survival genes
pSurv[SurvivalSubset & LassoSurv]                        #survival p-values Lasso genes
pSurv[NStageSubset]                                                   #survival p-values for N stage genes
pMicroNstage[NStageSubset]                                 #N stage p-values for N stage genes
pMicroNstage[NStageSubset & LassoNStage]  #N stage p-values Lasso genes
pMicroNstage[SurvivalSubset]                                #N stage p-values for survival  genes
whmiss <- which(is.na(apply(xPCR,2,mean)))
xPCR2 <- xPCR[,-whmiss]
pSurv2 <- pSurv[-whmiss]
pMicroNstage2 <- pMicroNstage[-whmiss]
LassoNStage2 <- LassoNStage[-whmiss]
LassoSurv2 <- LassoSurv[-whmiss]
SurvivalSubset2 <- SurvivalSubset[-whmiss]
NStageSubset2 <- NStageSubset[-whmiss]
pcrsd <- apply(xPCR2,2,sd)
dim(xPCR2)
resp <- factor(NStage)
xPCR2cen <- t(t(xPCR2) - apply(xPCR2,2,mean))
xPCR2stand <- t(t(xPCR2cen)/apply(xPCR2cen,2,sd))
firstPartition <- CreatePartition(pcrsd,decreasing=TRUE,uniform=TRUE,grsize=9)
secondPartition <- CreatePartition(pMicroNstage2,decreasing=FALSE,uniform=TRUE,grsize=9)
thirdPartition <- CreatePartition(factor(LassoNStage2))
partitionsOramod0 <- list(pvals=secondPartition,
lassosel=thirdPartition)
partitionsOramod <- list(sds=firstPartition,pvals=secondPartition,
lassosel=thirdPartition)
grOra <- grridge(t(xPCR2cen),resp,unpenal=~1,partitionsOramod,innfold=ncol(xPCR2cen),
monotone = c(FALSE,TRUE,FALSE),
selection=TRUE,stepsel=1,maxsel=15,comparelasso=TRUE, savepredobj="all",method="exact")
library(GRridge)
library(GRridge)
setwd("C:\\VUData\\Dennis")
load("OraMod.Rdata")
#"cNStage":                      Clinical N stage
#"ConcludingN":             N stage + delayed lymph node (alleen vumc)
#"CoxTime":      Time of death or time of censoring
#"LassoNStage":             lasso selected for N stage (thus lower p-value for N stage)
#"LassoSurv":   lasso selected for survival (thus lower p-value for survival)
#"NStage":                        Combination of ConcludingN (for vumc) and clinical N (for parma)
#"NStageSubset":          N stage genes
#"pMicroNstage":          Univariate p-value of N stage (on vumc micro data only, and not fishers combined p-vale)
#"pMicroSurv":                Univariate p-value of survival (vumc data, 2 genes were selected on Neomark and have a high pvalue)
#"pvalSurvNM":              This contains two values, for the two genes selected on NM data
#"Survival":        Survival, 1 is event/death
#"SurvivalSubset":Survival genes (some overlap with N stage)
#"xPCR":             PCR data (houskeeping gene GUSB subtracted)
pSurv <- pMicroSurv
pSurv[!is.na(pvalSurvNM)] <- pvalSurvNM[!is.na(pvalSurvNM)]
pSurv[SurvivalSubset]                                                  #survival p-values for survival genes
pSurv[SurvivalSubset & LassoSurv]                        #survival p-values Lasso genes
pSurv[NStageSubset]                                                   #survival p-values for N stage genes
pMicroNstage[NStageSubset]                                 #N stage p-values for N stage genes
pMicroNstage[NStageSubset & LassoNStage]  #N stage p-values Lasso genes
pMicroNstage[SurvivalSubset]                                #N stage p-values for survival  genes
whmiss <- which(is.na(apply(xPCR,2,mean)))
xPCR2 <- xPCR[,-whmiss]
pSurv2 <- pSurv[-whmiss]
pMicroNstage2 <- pMicroNstage[-whmiss]
LassoNStage2 <- LassoNStage[-whmiss]
LassoSurv2 <- LassoSurv[-whmiss]
SurvivalSubset2 <- SurvivalSubset[-whmiss]
NStageSubset2 <- NStageSubset[-whmiss]
pcrsd <- apply(xPCR2,2,sd)
dim(xPCR2)
resp <- factor(NStage)
xPCR2cen <- t(t(xPCR2) - apply(xPCR2,2,mean))
xPCR2stand <- t(t(xPCR2cen)/apply(xPCR2cen,2,sd))
firstPartition <- CreatePartition(pcrsd,decreasing=TRUE,uniform=TRUE,grsize=9)
secondPartition <- CreatePartition(pMicroNstage2,decreasing=FALSE,uniform=TRUE,grsize=9)
thirdPartition <- CreatePartition(factor(LassoNStage2))
partitionsOramod0 <- list(pvals=secondPartition,
lassosel=thirdPartition)
partitionsOramod <- list(sds=firstPartition,pvals=secondPartition,
lassosel=thirdPartition)
grOra <- grridge(t(xPCR2cen),resp,unpenal=~1,partitionsOramod,innfold=ncol(xPCR2cen),
monotone = c(FALSE,TRUE,FALSE),
selection=TRUE,stepsel=1,maxsel=15,comparelasso=TRUE, savepredobj="all",method="exact")
pMicroNstage2
sort(pMicroNstage2)
thirdPartition <- CreatePartition(pcrsd,decreasing=TRUE,uniform=TRUE,grsize=18)
secondPartition <- CreatePartition(pMicroNstage2,decreasing=FALSE,uniform=TRUE,grsize=18)
firstPartition <- CreatePartition(factor(LassoNStage2))
partitionsOramod <- list(lassosel=firstPartition,pvals=secondPartition,sds=thirdPartition,)
partitionsOramod <- list(lassosel=firstPartition,pvals=secondPartition,
sds=thirdPartition)
grOra <- grridge(t(xPCR2cen),resp,unpenal=~1,partitionsOramod,innfold=ncol(xPCR2cen),
monotone = c(FALSE,TRUE,FALSE),
selection=FALSE,stepsel=1,maxsel=15,comparelasso=TRUE, savepredobj="all",method="exact")
psig <- factor(pMicroNstage2 <= 0.05)
#secondPartition <- CreatePartition(pMicroNstage2,decreasing=FALSE,uniform=TRUE,grsize=18)
secondPartition <- CreatePartition(psig)
psig
partitionsOramod <- list(lassosel=firstPartition,pvals=secondPartition,
sds=thirdPartition)
grOra <- grridge(t(xPCR2cen),resp,unpenal=~1,partitionsOramod,innfold=ncol(xPCR2cen),
monotone = c(FALSE,FALSE,FALSE),
selection=FALSE,stepsel=1,maxsel=15,comparelasso=TRUE, savepredobj="all",method="exact")
pcrsd
grOra <- grridge(t(xPCR2cen),resp,unpenal=~1,partitionsOramod,innfold=ncol(xPCR2cen),
monotone = c(FALSE,FALSE,FALSE),
selection=FALSE,stepsel=1,maxsel=15,comparelasso=TRUE, savepredobj="all",method="stable")
psig <- factor(pMicroNstage2 <= 0.001)
#secondPartition <- CreatePartition(pMicroNstage2,decreasing=FALSE,uniform=TRUE,grsize=18)
secondPartition <- CreatePartition(psig)
firstPartition <- CreatePartition(factor(LassoNStage2))
partitionsOramod0 <- list(pvals=secondPartition,
lassosel=thirdPartition)
partitionsOramod <- list(lassosel=firstPartition,pvals=secondPartition,
sds=thirdPartition)
grOra <-
grridge(t(xPCR2cen),resp,unpenal=~1,partitionsOramod,innfold=ncol(xPCR2cen),
monotone = c(FALSE,FALSE,FALSE),selection=FALSE,stepsel=1,maxsel=15,comparelasso=TRUE, savepredobj="all",method="stable")
pSurv
xPCR2cen
nsam <- ncol(xPCR2cen)
subs <- sample(1:sam,50)
grOra <- grridge(t(xPCR2cen[subs,]),resp[subs],unpenal=~1,partitionsOramod,innfold=10,
monotone = c(FALSE,FALSE,FALSE),selection=FALSE,stepsel=1,maxsel=15,comparelasso=FALSE, savepredobj="all",method="stable")
nsam <- ncol(xPCR2cen)
subs <- sample(1:nsam,50)
grOra <- grridge(t(xPCR2cen[subs,]),resp[subs],unpenal=~1,partitionsOramod,innfold=10,
monotone = c(FALSE,FALSE,FALSE),selection=FALSE,stepsel=1,maxsel=15,comparelasso=FALSE, savepredobj="all",method="stable")
grOra <- grridge(t(xPCR2cen[subs,]),resp[subs],unpenal=~1,partitionsOramod,innfold=10,
monotone = c(FALSE,FALSE,FALSE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="exact")
grOra.cv <- grridge.cv(grOra,t(xPCR2cen[subs,]),resp,outerfold=10)
grOra <- grridge(t(Xsel),resp[subs],unpenal=~1,partitionsOramod,innfold=10,
monotone = c(FALSE,FALSE,FALSE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="exact")
Xsel <- xPCR2cen[subs,]
grOra <- grridge(t(Xsel),resp[subs],unpenal=~1,partitionsOramod,innfold=10,
monotone = c(FALSE,FALSE,FALSE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="exact")
grOra.cv <- grridge.cv(grOra,t(Xsel),resp,outerfold=10)
grOra.cv <- grridge.cv(grOra,t(Xsel),resp[subs],outerfold=10)
cutoffs <- rev(seq(0,1,by=0.01))
rocridge <- GRridge:::roc(probs=grOra.cv[,2],true=grOra.cv[,1],cutoffs=cutoffs)
aucr <- GRridge:::auc(rocridge)
rocgrridge <- GRridge:::roc(probs=grOra.cv[,3],true=grOra.cv[,1],cutoffs=cutoffs)
aucgr <- GRridge:::auc(rocgrridge)
aucr
aucgr
grOra.cv
grOra <- grridge(t(Xsel),resp[subs],unpenal=~0,partitionsOramod,innfold=10,
monotone = c(FALSE,FALSE,FALSE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="exact")
grOra.cv <- grridge.cv(grOra,t(Xsel),resp[subs],outerfold=10)
cutoffs <- rev(seq(0,1,by=0.01))
rocridge <- GRridge:::roc(probs=grOra.cv[,2],true=grOra.cv[,1],cutoffs=cutoffs)
aucr <- GRridge:::auc(rocridge)
rocgrridge <- GRridge:::roc(probs=grOra.cv[,3],true=grOra.cv[,1],cutoffs=cutoffs)
aucgr <- GRridge:::auc(rocgrridge)
aucr
aucgr
grOra.cv
grOra.cv <- grridge.cv(grOra,t(Xsel),resp[subs],outerfold=25)
cutoffs <- rev(seq(0,1,by=0.01))
rocridge <- GRridge:::roc(probs=grOra.cv[,2],true=grOra.cv[,1],cutoffs=cutoffs)
aucr <- GRridge:::auc(rocridge)
rocgrridge <- GRridge:::roc(probs=grOra.cv[,3],true=grOra.cv[,1],cutoffs=cutoffs)
aucgr <- GRridge:::auc(rocgrridge)
grOra.cv
nsam <- ncol(xPCR2cen)
subs <- sample(1:nsam,80)
Xsel <- xPCR2cen[subs,]
grOra <- grridge(t(Xsel),resp[subs],unpenal=~0,partitionsOramod,innfold=10,
monotone = c(FALSE,FALSE,FALSE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="exact")
grOra.cv <- grridge.cv(grOra,t(Xsel),resp[subs],outerfold=25)
cutoffs <- rev(seq(0,1,by=0.01))
rocridge <- GRridge:::roc(probs=grOra.cv[,2],true=grOra.cv[,1],cutoffs=cutoffs)
aucr <- GRridge:::auc(rocridge)
rocgrridge <- GRridge:::roc(probs=grOra.cv[,3],true=grOra.cv[,1],cutoffs=cutoffs)
aucgr <- GRridge:::auc(rocgrridge)
aucr
aucgr
partitionsOramod <- list(lassosel=firstPartition)
nsam <- ncol(xPCR2cen)
subs <- sample(1:nsam,80)
Xsel <- xPCR2cen[subs,]
grOra <- grridge(t(Xsel),resp[subs],unpenal=~0,partitionsOramod,innfold=10,
monotone = c(FALSE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="exact")
grOra.cv <- grridge.cv(grOra,t(Xsel),resp[subs],outerfold=25)
cutoffs <- rev(seq(0,1,by=0.01))
rocridge <- GRridge:::roc(probs=grOra.cv[,2],true=grOra.cv[,1],cutoffs=cutoffs)
aucr <- GRridge:::auc(rocridge)
rocgrridge <- GRridge:::roc(probs=grOra.cv[,3],true=grOra.cv[,1],cutoffs=cutoffs)
aucgr <- GRridge:::auc(rocgrridge)
aucr
aucgr
Xsel <- xPCR2cen[subs,]
grOra <- grridge(t(Xsel),resp[subs],unpenal=~1,partitionsOramod,innfold=10,
monotone = c(FALSE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="exact")
grOra <- grridge(t(Xsel),resp[subs],unpenal=~1,partitionsOramod,innfold=10,
monotone = c(FALSE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="stable")
grOra.cv <- grridge.cv(grOra,t(Xsel),resp[subs],outerfold=25)
cutoffs <- rev(seq(0,1,by=0.01))
rocridge <- GRridge:::roc(probs=grOra.cv[,2],true=grOra.cv[,1],cutoffs=cutoffs)
aucr <- GRridge:::auc(rocridge)
rocgrridge <- GRridge:::roc(probs=grOra.cv[,3],true=grOra.cv[,1],cutoffs=cutoffs)
aucgr <- GRridge:::auc(rocgrridge)
aucr
aucgr
Xsel <- xPCR2cen[subs,]
grOra <- grridge(t(Xsel),resp[subs],unpenal=~0,partitionsOramod,innfold=10,
monotone = c(FALSE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="stable")
grOra.cv <- grridge.cv(grOra,t(Xsel),resp[subs],outerfold=25)
cutoffs <- rev(seq(0,1,by=0.01))
rocridge <- GRridge:::roc(probs=grOra.cv[,2],true=grOra.cv[,1],cutoffs=cutoffs)
aucr <- GRridge:::auc(rocridge)
rocgrridge <- GRridge:::roc(probs=grOra.cv[,3],true=grOra.cv[,1],cutoffs=cutoffs)
aucgr <- GRridge:::auc(rocgrridge)
aucr
aucgr
nsam <- ncol(xPCR2cen)
subs <- sample(1:nsam,80)
Xsel <- xPCR2cen[subs,]
grOra <- grridge(t(Xsel),resp[subs],unpenal=~0,partitionsOramod,innfold=10,
monotone = c(FALSE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="stable")
grOra.cv <- grridge.cv(grOra,t(Xsel),resp[subs],outerfold=40)
grOra.cv
nsam <- ncol(xPCR2cen)
subs <- sample(1:nsam,80)
Xsel <- xPCR2cen[subs,]
grOra <- grridge(t(Xsel),resp[subs],unpenal=~0,partitionsOramod,innfold=10,
monotone = c(FALSE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="stable")
grOra0 <- grridge(t(xPCR2stand),resp,unpenal=~1,partitionsOramod0,
innfold=ncol(xPCR2stand),niter=0,
monotone = c(TRUE,FALSE),comparelasso=TRUE,selection=TRUE,stepsel=1,maxsel=15, savepredobj="all",method="exact")
grOra.cv <- grridge.cv(grOra,t(Xsel),resp[subs],outerfold=40)
partitionsOramod <- list(pvals=secondPartition)
#partitionsOramod <- list(lassosel=firstPartition)
nsam <- ncol(xPCR2cen)
subs <- sample(1:nsam,80)
Xsel <- xPCR2cen[subs,]
grOra <- grridge(t(Xsel),resp[subs],unpenal=~0,partitionsOramod,innfold=10,
monotone = c(FALSE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="stable")
grOra.cv <- grridge.cv(grOra,t(Xsel),resp[subs],outerfold=40)
subs
nsam <- ncol(xPCR2cen)
Xsel <- xPCR2cen
grOra <- grridge(t(Xsel),resp,unpenal=~0,partitionsOramod,innfold=10,
monotone = c(FALSE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="exact")
partitionsOramod <- list(lassosel=firstPartition)
nsam <- ncol(xPCR2cen)
Xsel <- xPCR2cen
grOra <- grridge(t(Xsel),resp,unpenal=~0,partitionsOramod,innfold=10,
monotone = c(FALSE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="exact")
grOra <- grridge(t(Xsel),resp,unpenal=~0,partitionsOramod,innfold=10,
monotone = c(FALSE),selection=FALSE,stepsel=1,maxsel=15,fixedfold=FALSE,
comparelasso=FALSE, savepredobj="all",method="exact")
grOra <- grridge(t(Xsel),resp,unpenal=~0,partitionsOramod,innfold=10,
monotone = c(FALSE),selection=FALSE,stepsel=1,maxsel=15,fixedfold=FALSE,
comparelasso=FALSE, savepredobj="all",method="exact")
grOra <- grridge(t(Xsel),resp,unpenal=~0,partitionsOramod,innfold=10,
monotone = c(FALSE),selection=FALSE,stepsel=1,maxsel=15,fixedfold=FALSE,
comparelasso=FALSE, savepredobj="all",method="exact")
grOra <- grridge(t(Xsel),resp,unpenal=~0,partitionsOramod,innfold=10,
monotone = c(FALSE),selection=FALSE,stepsel=1,maxsel=15,fixedfold=FALSE,
comparelasso=FALSE, savepredobj="all",method="exact")
grOra <- grridge(t(Xsel),resp,unpenal=~0,partitionsOramod,innfold=10,
monotone = c(FALSE),selection=FALSE,stepsel=1,maxsel=15,fixedfold=FALSE,
comparelasso=FALSE, savepredobj="all",method="exact")
partitionsOramod <- list(pvals=secondPartition)
#partitionsOramod <- list(lassosel=firstPartition)
nsam <- ncol(xPCR2cen)
Xsel <- xPCR2cen
grOra <- grridge(t(Xsel),resp,unpenal=~0,partitionsOramod,innfold=10,
monotone = c(FALSE),selection=FALSE,stepsel=1,maxsel=15,fixedfold=FALSE,
comparelasso=FALSE, savepredobj="all",method="exact")
partitionsOramod <- list(pvals=secondPartition)
#partitionsOramod <- list(lassosel=firstPartition)
nsam <- ncol(xPCR2cen)
Xsel <- xPCR2cen
grOra <- grridge(t(Xsel),resp,unpenal=~0,partitionsOramod,innfold=10,
monotone = c(FALSE),selection=FALSE,stepsel=1,maxsel=15,fixedfold=FALSE,
comparelasso=FALSE, savepredobj="all",method="exact")
partitionsOramod <- list(pvals=secondPartition)
#partitionsOramod <- list(lassosel=firstPartition)
nsam <- ncol(xPCR2cen)
Xsel <- xPCR2cen
grOra <- grridge(t(Xsel),resp,unpenal=~0,partitionsOramod,innfold=10,
monotone = c(FALSE),selection=FALSE,stepsel=1,maxsel=15,fixedfold=FALSE,
comparelasso=FALSE, savepredobj="all",method="exact")
pSurv
partitionsOramod <- list(pvals=secondPartition,lassosel=firstPartition,sds = thirdPartition)
#partitionsOramod <- list()
nsam <- ncol(xPCR2cen)
Xsel <- xPCR2cen
grOra <- grridge(t(Xsel),resp,unpenal=~0,partitionsOramod,innfold=10,
monotone = c(FALSE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="exact")
grOra <- grridge(t(Xsel),resp,unpenal=~0,partitionsOramod,innfold=10,
monotone = c(FALSE,FALSE,FALSE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="exact")
thirdPartition <- CreatePartition(pcrsd,decreasing=TRUE,uniform=TRUE,grsize=9)
partitionsOramod <- list(pvals=secondPartition,lassosel=firstPartition,
sds = thirdPartition)
Xsel <- xPCR2cen
grOra <- grridge(t(Xsel),resp,unpenal=~0,partitionsOramod,innfold=10,
monotone = c(FALSE,FALSE,FALSE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="exact")
cutoffs <- rev(seq(0,1,by=0.01))
rocridge <- GRridge:::roc(probs=grOra.cv[,2],true=grOra.cv[,1],cutoffs=cutoffs)
aucr <- GRridge:::auc(rocridge)
rocgrridge <- GRridge:::roc(probs=grOra.cv[,3],true=grOra.cv[,1],cutoffs=cutoffs)
aucgr <- GRridge:::auc(rocgrridge)
grOra.cv <- grridge.cv(grOra,t(Xsel),resp,outerfold=100)
grOra.cv <- grridge.cv(grOra,t(Xsel),resp,outerfold=10)
cutoffs <- rev(seq(0,1,by=0.01))
rocridge <- GRridge:::roc(probs=grOra.cv[,2],true=grOra.cv[,1],cutoffs=cutoffs)
aucr <- GRridge:::auc(rocridge)
rocgrridge <- GRridge:::roc(probs=grOra.cv[,3],true=grOra.cv[,1],cutoffs=cutoffs)
aucgr <- GRridge:::auc(rocgrridge)
aucr
aucgr
Survival
survresp <- Surv(Survival,CoxTime)
survresp <- Surv(CoxTime,Survival)
survresp
pSurv <- pMicroSurv
pSurv[!is.na(pvalSurvNM)] <- pvalSurvNM[!is.na(pvalSurvNM)]
pSurv[SurvivalSubset]                                                  #survival p-values for survival genes
pSurv[SurvivalSubset & LassoSurv]                        #survival p-values Lasso genes
pSurv[NStageSubset]                                                   #survival p-values for N stage genes
pMicroNstage[NStageSubset]                                 #N stage p-values for N stage genes
pMicroNstage[NStageSubset & LassoNStage]  #N stage p-values Lasso genes
pMicroNstage[SurvivalSubset]                                #N stage p-values for survival  genes
whmiss <- which(is.na(apply(xPCR,2,mean)))
xPCR2 <- xPCR[,-whmiss]
pSurv2 <- pSurv[-whmiss]
pMicroNstage2 <- pMicroNstage[-whmiss]
LassoNStage2 <- LassoNStage[-whmiss]
LassoSurv2 <- LassoSurv[-whmiss]
SurvivalSubset2 <- SurvivalSubset[-whmiss]
NStageSubset2 <- NStageSubset[-whmiss]
survresp <- Surv(CoxTime,Survival)
pcrsd <- apply(xPCR2,2,sd)
pcrsdpooled <- apply(xPCR2,2,sd)
dim(xPCR2)
resp <- factor(NStage)
xPCR2cen <- t(t(xPCR2) - apply(xPCR2,2,mean))
xPCR2stand <- t(t(xPCR2cen)/apply(xPCR2cen,2,sd))
secondPartition <- CreatePartition(pSurv2,decreasing=FALSE,uniform=TRUE,grsize=6)
partitionsSurv <- list(pvals=secondPartition)
nsam <- ncol(xPCR2cen)
Xsel <- xPCR2cen
grOraS <- grridge.surv(t(Xsel),survresp,unpenal=~0,partitionsSurv,innfold=10,
monotone = c(TRUE),selection=FALSE,stepsel=1,maxsel=15,fixedfold=FALSE,
comparelasso=FALSE, savepredobj="all",method="exact")
grridge.surv
source('C:/Synchr/Rscripts/Survival/grridgesurv.R')
source('C:/Synchr/Rscripts/Survival/grridgesurv.cv.R')
source('C:/Synchr/Rscripts/Survival/grridgesurv.R')
source('C:/Synchr/Rscripts/Survival/grridgesurv.cv.R')
grOraS <- grridge.surv(t(Xsel),survresp,unpenal=~0,partitionsSurv,innfold=10,
monotone = c(TRUE),selection=FALSE,stepsel=1,maxsel=15,fixedfold=FALSE,
comparelasso=FALSE, savepredobj="all",method="exact")
grOraS <- grridge.surv(t(Xsel),survresp,unpenal=~0,partitionsSurv,innfold=10,
monotone = c(FALSE),selection=FALSE,stepsel=1,maxsel=15,fixedfold=FALSE,
comparelasso=FALSE, savepredobj="all",method="exact")
grOraS <- grridge.surv(t(Xsel),survresp,unpenal=~0,partitionsSurv,innfold=10,
monotone = c(TRUE),selection=FALSE,stepsel=1,maxsel=15,fixedfold=FALSE,
comparelasso=FALSE, savepredobj="all",method="exact")
grOraS <- grridge.surv(t(Xsel),survresp,unpenal=~0,partitionsSurv,innfold=10,
monotone = c(TRUE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="exact")
grOraS.cv <- grridge.cv(grOraS,t(Xsel),survresp,outerfold=10)
grOraS.cv <- grridgesurv.cv(grOraS,t(Xsel),survresp,outerfold=10)
grOraS.cv <- grridge.surv.cv(grOraS,t(Xsel),survresp,outerfold=10)
grOraS.cv
str(grOraS.cv)
grOraS.cv$linpredmat
secondPartition <- CreatePartition(pMicroNstage2,decreasing=FALSE,
uniform=FALSE,ngroup=6,mingr=3)
secondPartition
secondPartition <- CreatePartition(pMicroNstage2,decreasing=FALSE,
uniform=FALSE,ngroup=6,mingr=3)
#secondPartition <- CreatePartition(psig)
firstPartition <- CreatePartition(factor(LassoNStage2))
partitionsOramod <- list(pvals=secondPartition,lassosel=firstPartition,
sds = thirdPartition)
partitionsOramod <- list(pvals=secondPartition)
#partitionsOramod <- list()
nsam <- ncol(xPCR2cen)
Xsel <- xPCR2cen
grOra <- grridge(t(Xsel),resp,unpenal=~0,partitionsOramod,innfold=10,
monotone = c(TRUE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="exact")
secondPartition <- CreatePartition(pMicroNstage2,decreasing=FALSE,
uniform=FALSE,ngroup=6,mingr=5)
#secondPartition <- CreatePartition(psig)
firstPartition <- CreatePartition(factor(LassoNStage2))
partitionsOramod <- list(pvals=secondPartition,lassosel=firstPartition,
sds = thirdPartition)
partitionsOramod <- list(pvals=secondPartition)
#partitionsOramod <- list()
nsam <- ncol(xPCR2cen)
Xsel <- xPCR2cen
grOra <- grridge(t(Xsel),resp,unpenal=~0,partitionsOramod,innfold=10,
monotone = c(TRUE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="exact")
firstPartition <- CreatePartition(factor(LassoNStage2))
partitionsOramod <- list(sel=secondPartition)
Xsel <- xPCR2cen
grOra <- grridge(t(Xsel),resp,unpenal=~0,partitionsOramod,innfold=10,
monotone = c(TRUE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="exact")
partitionsOramod <- list(sel=firstPartition)
#partitionsOramod <- list()
nsam <- ncol(xPCR2cen)
Xsel <- xPCR2cen
grOra <- grridge(t(Xsel),resp,unpenal=~0,partitionsOramod,innfold=10,
monotone = c(TRUE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="exact")
NStageSubset
LassoNStage2
LassoNStage
pMicroNstage[NStageSubset]                                 #N stage p-values for N stage genes
pMicroNstage[NStageSubset & LassoNStage]  #N stage p-values Lasso genes
pMicroNstage[SurvivalSubset]                                #N stage p-values for survival  genes
pMicroNstage[-NStageSubset]
pMicroNstage[!NStageSubset]
NStageSubset2
firstPartition <- CreatePartition(NStageSubset2)
firstPartition <- CreatePartition(factor(NStageSubset2))
firstPartition
partitionsOramod <- list(sel=firstPartition)
nsam <- ncol(xPCR2cen)
Xsel <- xPCR2cen
grOra <- grridge(t(Xsel),resp,unpenal=~0,partitionsOramod,innfold=10,
monotone = c(TRUE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="exact")
Xsel <- xPCR2cen
grOra <- grridge(t(Xsel),resp,unpenal=~0,partitionsOramod,innfold=10,
monotone = c(FALSE),selection=FALSE,stepsel=1,maxsel=15,
comparelasso=FALSE, savepredobj="all",method="exact")
library(GRridge)
partitionFarkas
data(datcenFarkas)
data(dataFarkas)
partitionFarkas
objects()
library(GRridge)
predict.grridge()
predict.grridge
CreatePartition()
?CreatePartition
